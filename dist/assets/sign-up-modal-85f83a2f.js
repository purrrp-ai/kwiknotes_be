import{r as h,C,j as o,L as A,x as y,a as T}from"./index-73886e4a.js";import{L as I}from"./logo-link-04dba84f.js";import{M as B}from"./Modal-96cf205e.js";import{F as c,T as u,a as w}from"./TextField-890f9e1c.js";import{F as M,V as H,a as P}from"./FormGroup-2d100d0c.js";import{I as S}from"./IconButton-692d3f3e.js";import{m as F}from"./makeStyles-8abd10b7.js";import"./useForkRef-f0f0758c.js";import"./useIsFocusVisible-a21fe620.js";import"./createSvgIcon-95652d7e.js";async function z(n){const i=await fetch("/api/sign-up",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(!i.ok){const{message:m}=await i.json();throw new Error(m)}return i.json()}const $="_top-section_1aagr_1",k="_form-wrapper_1aagr_25",N="_hide-wrapper_1aagr_73",W="_sign-up-btn_1aagr_93",f={"top-section":"_top-section_1aagr_1",topSection:$,"form-wrapper":"_form-wrapper_1aagr_25",formWrapper:k,"hide-wrapper":"_hide-wrapper_1aagr_73",hideWrapper:N,"sign-up-btn":"_sign-up-btn_1aagr_93",signUpBtn:W},Z=F({default:{"&":{"& .MuiFormControl-root":{"& .MuiFormLabel-root":{font:"inherit",pointerEvents:"none",userSelect:"none",color:"inherit"},"& .MuiInputBase-root":{font:"inherit",color:"inherit",marginBottom:"1em","&::before":{borderBottom:"1px solid hsla(0, 0%, 0%, 0.3)"},"&:hover::before":{borderBottom:"1px solid hsla(0, 0%, 0%, 0.6)"},"&::after":{borderBottom:"1px solid hsla(0, 0%, 0%, 0.9)"}},"& .MuiIconButton-root":{fontSize:"1.3em","& .MuiSvgIcon-root":{fontSize:"1em",color:"hsla(0, 0%, 0%, 0.6)"},"&:hover .MuiSvgIcon-root, &:focus .MuiSvgIcon-root":{color:"hsla(0, 0%, 0%, 0.9)"}}},"& .MuiFormHelperText-root":{all:"unset",position:"absolute",width:"max-content",color:"#f44335",right:0,bottom:"0.1em",margin:"0 auto",fontSize:"0.75em",fontWeight:"bolder",lineHeight:"1em",pointerEvents:"none",userSelect:"none"}}},emailField:{"&":{"& .MuiFormControl-root":{"& .MuiInputBase-root":{minWidth:"24ch"}}}},confirmPassword:{"&":{marginBottom:"1em"}},modal:{"&":{display:"grid",placeItems:"center","& .MuiBackdrop-root":{backgroundColor:"rgba(0, 0, 0, 0)"}}}});function K(){const n=Z(),{showSignUp:i,setShowSignUp:m,setShowSignIn:j,setMessage:x}=h.useContext(C),[a,s]=h.useState({username:"",usernameHelperText:null,email:"",emailHelperText:null,password:"",passwordHelperText:null,confirmPassword:"",confirmPasswordHelperText:null,showPassword:!1,showConfirmPassword:!1,creatingAccount:!1}),[b,p]=h.useState(!1);setTimeout(i?()=>p(!0):()=>p(!1),150);const g=r=>s(e=>({...e,[r]:!e[r]})),_=r=>{s(t=>({...t,creatingAccount:!0})),r.preventDefault();const e={username:a.username,email:a.email,password:a.password,password_confirmation:a.confirmPassword};z(e).then(t=>{const{username:l}=t;p(!1),setTimeout(()=>m(!1),150),s(d=>({...d,creatingAccount:!1,email:"",username:"",password:"",confirmPassword:""})),x({color:T.success,info:`Sign up successful. Account with username ${l} has been created.`})}).catch(t=>{const{message:l}=t;/email/.test(l)?s(d=>({...d,signingIn:!1,emailHelperText:l})):new RegExp(e.username).test(l)?s(d=>({...d,signingIn:!1,usernameHelperText:l})):x({color:T.error,info:l})}).finally(()=>{s(t=>({...t,creatingAccount:!1})),setTimeout(()=>{s(t=>({...t,usernameHelperText:null,emailHelperText:null,passwordHelperText:null,confirmPasswordHelperText:null}))},4e3)})};return o.jsx(B,{open:i,onClose:()=>{p(!1),setTimeout(()=>i(!1),150)},className:n.modal,children:o.jsxs("div",{className:`${f.formWrapper} ${!b&&f.hideWrapper}`,children:[o.jsx("div",{className:f.topSection,children:o.jsx(I,{w:1.75})}),o.jsx("h1",{children:"Create an account"}),o.jsxs("form",{onSubmit:_,children:[o.jsxs(c,{className:`${n.default} ${n.emailField}`,children:[o.jsx(u,{variant:"standard",id:"email",type:"email",name:"email",onChange:({target:{value:r}})=>{s(e=>({...e,email:r})),r?/^(?=[a-zA-Z0-9._%+-]{1,64}@([a-zA-Z0-9.-]{1,253}\.){1,5}[a-zA-Z]{2,63}$)[a-zA-Z0-9._%+-]{1,64}@([a-zA-Z0-9.-]{1,253}\.){1,5}[a-zA-Z]{2,63}$/.test(r)?s(e=>({...e,emailHelperText:null})):s(e=>({...e,emailHelperText:"Invalid email format"})):s(e=>({...e,emailHelperText:null}))},value:a.email,label:"EMAIL",error:!!a.emailHelperText}),o.jsx(w,{children:a.emailHelperText})]}),o.jsxs(c,{className:`${n.default}`,children:[o.jsx(u,{variant:"standard",id:"username",type:"text",name:"username",onChange:({target:{value:r}})=>{s(e=>({...e,username:r})),r?r.length<3?s(e=>({...e,usernameHelperText:"username is too short"})):r.length>15?s(e=>({...e,usernameHelperText:"username cannot be more that 20 characters"})):/[^\w\d.-]/.test(r)?s(e=>({...e,usernameHelperText:"Allowed username characters: [a-z, A-Z, 0-9, _, -, .]"})):/^[.-]|[.-]$/.test(r)?s(e=>({...e,usernameHelperText:"username cannot start or end with a period/hyphen"})):/[.-]{2,}/.test(r)?s(e=>({...e,usernameHelperText:"consecutive hyphens/periods aren't allowed"})):s(e=>({...e,usernameHelperText:null})):s(e=>({...e,usernameHelperText:null}))},value:a.username,label:"USERNAME",error:!!a.usernameHelperText}),o.jsx(w,{children:a.usernameHelperText})]}),o.jsxs(M,{className:`${n.default} ${n.confirmPassword}`,children:[o.jsxs(c,{children:[o.jsx(u,{variant:"standard",id:"password",type:a.showPassword?"text":"password",name:"password",onChange:({target:{value:r}})=>{s(e=>({...e,password:r})),r?r.length<9?s(e=>({...e,passwordHelperText:"Password is too short"})):/(?=.*\d)/.test(r)?/(?=.*[a-z])/.test(r)?/(?=.*[A-Z])/.test(r)?/(?=.*[^a-zA-Z\d])/.test(r)?/(?=.*[^\w.!@#$%^&*()])/.test(r)?s(e=>({...e,passwordHelperText:"allowed characters: [a-z, A-Z, _, ., !, @, #, $, %, ^, &, *, (, )]"})):s(e=>({...e,passwordHelperText:null})):s(e=>({...e,passwordHelperText:"password should have a special character"})):s(e=>({...e,passwordHelperText:"password should have an uppercase letter"})):s(e=>({...e,passwordHelperText:"password should have a lowercase letter"})):s(e=>({...e,passwordHelperText:"password should have a number"})):s(e=>({...e,passwordHelperText:null}))},value:a.password,label:"PASSWORD",error:!!a.passwordHelperText,InputProps:{endAdornment:o.jsx(S,{"aria-label":a.showPassword?"Hide password":"Show password","aria-pressed":a.showPassword,onClick:()=>g("showPassword"),children:a.showPassword?o.jsx(H,{}):o.jsx(P,{})})}}),o.jsx(w,{children:a.passwordHelperText})]}),o.jsxs(c,{children:[o.jsx(u,{variant:"standard",id:"confirm-password",type:a.showConfirmPassword?"text":"password",name:"confirmPassword",onChange:({target:{value:r}})=>{s(e=>({...e,confirmPassword:r})),r?r!=a.password?s(e=>({...e,confirmPasswordHelperText:"Password does not match"})):r==a.password&&s(e=>({...e,confirmPasswordHelperText:null})):s(e=>({...e,confirmPasswordHelperText:null}))},disabled:!a.password,value:a.confirmPassword,label:"CONFIRM PASSWORD",error:!!a.confirmPasswordHelperText,InputProps:{endAdornment:o.jsx(S,{"aria-label":a.showConfirmPassword?"Show password confirmation value":"Hide password confirmation value","aria-pressed":a.showConfirmPassword,onClick:()=>g("showConfirmPassword"),children:a.showConfirmPassword?o.jsx(H,{}):o.jsx(P,{})})}}),o.jsx(w,{children:a.confirmPasswordHelperText})]})]}),a.creatingAccount?o.jsx(A,{sx:{marginBlock:3.325},color:"inherit"}):o.jsx("button",{className:f.signUpBtn,id:"sign-up__btn",type:"submit",children:"Sign Up"})]}),o.jsxs("p",{children:["Already a ",o.jsx(y,{to:"/",children:"Kwik Notes"})," user?"," ",o.jsx("button",{type:"button",onClick:()=>{p(!1),s(r=>({...r,email:"",username:"",password:"",confirmPassword:""})),setTimeout(()=>{m(!1),j(!0)},150)},children:"Sign In"})]})]})})}export{K as default};
