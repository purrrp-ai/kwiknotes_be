import{j as e,r as p,C as j,c as F,a}from"./index-73886e4a.js";import{m as k,B as w}from"./makeStyles-8abd10b7.js";import{P as C,a as N,I as f,A as q,b as S,C as v,c as y,M as P}from"./header-f9be09ae.js";import{T as _}from"./TextField-890f9e1c.js";import{c}from"./createSvgIcon-95652d7e.js";import{C as M}from"./CircularProgress-e7129798.js";const B=c(e.jsx("path",{d:"M7 14c-1.66 0-3 1.34-3 3 0 1.31-1.16 2-2 2 .92 1.22 2.49 2 4 2 2.21 0 4-1.79 4-4 0-1.66-1.34-3-3-3zm13.71-9.37-1.34-1.34a.9959.9959 0 0 0-1.41 0L9 12.25 11.75 15l8.96-8.96c.39-.39.39-1.02 0-1.41z"}),"Brush"),I=c(e.jsx("path",{d:"M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.11 0 2-.9 2-2V5c0-1.1-.89-2-2-2zm-9 14-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"}),"CheckBox"),O=c(e.jsx("path",{d:"M18.4 10.6C16.55 8.99 14.15 8 11.5 8c-4.65 0-8.58 3.03-9.96 7.22L3.9 16c1.05-3.19 4.05-5.5 7.6-5.5 1.95 0 3.73.72 5.12 1.88L13 16h9V7l-3.6 3.6z"}),"Redo"),R=c(e.jsx("path",{d:"M12.5 8c-2.65 0-5.05.99-6.9 2.6L2 7v9h9l-3.62-3.62c1.39-1.16 3.16-1.88 5.12-1.88 3.54 0 6.55 2.31 7.6 5.5l2.37-.78C21.08 11.03 17.15 8 12.5 8z"}),"Undo"),W="_create-wrapper_110qe_1",z="_create-wrapper-flex_110qe_41",A="_note-props_110qe_59",L="_pin-checkbox_110qe_71",H="_more-options_110qe_139",E="_toolbar-btns_110qe_205",T="_pre-modes_110qe_227",U="_toggle-wrapper_110qe_253",$="_pulse_110qe_1",D="_ripple_110qe_1",l={"create-wrapper":"_create-wrapper_110qe_1",createWrapper:W,"create-wrapper-flex":"_create-wrapper-flex_110qe_41",createWrapperFlex:z,"note-props":"_note-props_110qe_59",noteProps:A,"pin-checkbox":"_pin-checkbox_110qe_71",pinCheckbox:L,"more-options":"_more-options_110qe_139",moreOptions:H,"toolbar-btns":"_toolbar-btns_110qe_205",toolbarBtns:E,"pre-modes":"_pre-modes_110qe_227",preModes:T,"toggle-wrapper":"_toggle-wrapper_110qe_253",toggleWrapper:U,pulse:$,ripple:D},V=[{icon:e.jsx(q,{}),clickFunc:()=>null,tooltip:"Prompt me"},{icon:e.jsx(S,{}),clickFunc:()=>null,tooltip:"Partner"},{icon:e.jsx(v,{}),clickFunc:()=>null,tooltip:"Environment alternatives"},{icon:e.jsx(f,{}),clickFunc:()=>null,tooltip:"Insert picture"},{icon:e.jsx(y,{}),clickFunc:()=>null,tooltip:"Stash"},{icon:e.jsx(P,{}),clickFunc:()=>null,tooltip:"Extra"},{icon:e.jsx(R,{}),clickFunc:()=>null,tooltip:"Undo"},{icon:e.jsx(O,{}),clickFunc:()=>null,tooltip:"Redo"}],G=k({titleField:{"& .MuiOutlinedInput-root":{minHeight:48,padding:"0.75em 1em",borderRadius:8,fontFamily:"inherit",color:"inherit",lineHeight:"1.5em",fontWeight:"bolder","& .MuiOutlinedInput-notchedOutline":{display:"none"}}},contentField:{"& .MuiOutlinedInput-root":{minHeight:48,fontFamily:'"Gloria Hallelujah", cursive',fontSize:"0.9em",letterSpacing:"0.01428571em",lineHeight:"1.25em",padding:"0.86em 1.111em",borderRadius:8,color:"inherit","& .MuiOutlinedInput-notchedOutline":{display:"none"}}}}),K=()=>{const d=G(),{user:b,setUser:u,setMessage:r,setShowSignIn:x}=p.useContext(j),[o,i]=p.useState({expandForm:!1,title:"",content:"",pinned:!1,addingNote:!1}),m=p.useRef(null);function h(n){if(n.preventDefault(),b){if(i(t=>({...t,addingNote:!0})),!o.title&&!o.content)return i(t=>({...t,expandForm:!1,addingNote:!1}));F({title:o.title,content:o.content,pinned:o.pinned}).then(({note:t})=>{u(s=>({...s,notes:s.notes.concat(t)})),r({color:a.success,info:"Note added."}),i(s=>({...s,expandForm:!1,title:"",content:"",pinned:!1}))}).catch(({message:t})=>{t==="token expired"?(window.localStorage.removeItem("token"),u(null),x(!0),setTimeout(()=>r({color:a.warn,info:"Session expired. Please Sign in again."}),1e3)):r({color:a.error,info:t})}).finally(()=>i(t=>({...t,addingNote:!1})))}else i(t=>({...t,expandForm:!o.title&&!o.content?!1:t.expandForm})),x(!0),r({color:a.warn,info:"Sign in to add notes."})}function g(n){n.preventDefault(),o.title||o.content?h(n):i(t=>({...t,expandForm:!1}))}return e.jsxs(e.Fragment,{children:[e.jsx(w,{open:o.expandForm,onClick:n=>g(n),sx:{backgroundColor:"rgba(0, 0, 0, 0.1)"}}),e.jsxs("form",{method:"post",className:l.createWrapper,tabIndex:0,onKeyDown:n=>{n.key==="Enter"&&(n.preventDefault(),i(t=>({...t,expandForm:!0})),m.current.focus())},onSubmit:h,children:[e.jsxs("div",{className:l.noteProps,children:[o.expandForm&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:l.pinCheckbox,children:[e.jsx("input",{type:"checkbox",checked:o.pinned,onChange:({target:n})=>i(t=>({...t,pinned:n.checked})),value:o.pinned?"unpinned":"pinned","aria-label":o.pinned?"Unpin note":"Pin note","aria-pressed":o.pinned}),o.pinned?e.jsx(C,{fontSize:"1em"}):e.jsx(N,{fontSize:"1em"})]}),e.jsx(_,{multiline:!0,maxRows:16,className:d.titleField,placeholder:"Title",onChange:({target:n})=>i(t=>({...t,title:n.value})),fullWidth:!0,value:o.title,sx:{display:"block"}})]}),e.jsx(_,{multiline:!0,maxRows:24,className:d.contentField,placeholder:"Take a note...",onChange:({target:n})=>i(t=>({...t,content:n.value})),fullWidth:!0,value:o.content,sx:{display:"block"},inputProps:{onFocus:()=>i(n=>({...n,expandForm:!0}))},ref:m})]}),!o.expandForm&&e.jsx("div",{className:`${l.preModes}`,children:[{icon:e.jsx(I,{}),label:"New list"},{icon:e.jsx(B,{}),label:"New note with drawing"},{icon:e.jsx(f,{}),label:"New note with image"}].map((n,t)=>e.jsx("button",{"aria-label":n.label,type:"button",color:"inherit",children:n.icon},n.label+t))}),o.expandForm&&e.jsxs("div",{className:l.moreOptions,children:[e.jsx("div",{className:l.toolbarBtns,children:V.map((n,t)=>e.jsx("button",{type:"button","aria-label":n.tooltip,onClick:n.clickFunc,children:n.icon},`${t}${n.tooltip}`))}),o.addingNote?e.jsx(M,{sx:{width:"20px !important",height:"20px !important",margin:"8px 24px"},color:"inherit"}):e.jsx("button",{type:"submit",disabled:o.addingNote,children:"Close"})]})]})]})},te=K;export{te as A};
